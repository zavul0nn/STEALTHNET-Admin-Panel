client.chrnet.ru {
    encode gzip zstd

    # Проксирование API запросов на Flask бэкенд
    handle /api/* {
        reverse_proxy localhost:5000 {
            header_up Host {host}
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
            transport http {
                read_buffer 0
            }
        }
    }

    # Отдача статических файлов из build директории
    handle {
        root * /admpanel/admin-panel/build
        
        # Для SPA роутинга: если файл не найден, отдаем index.html
        try_files {path} /index.html
        
        file_server
    }
}

